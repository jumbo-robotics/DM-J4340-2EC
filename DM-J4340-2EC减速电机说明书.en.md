# DM-J4340-2EC Reduction Motor User Manual

*Version: V1.0*
*Total Pages: 9*

---

## Page 1

### DAMIAO | Damiao Technology
Reduction Motor
DM-J4340-2EC
User Manual
V1.0 2024.03.14
Date Version Change Content
2024.03.14 V1.0 Initial version creation
Page 1 of 9

---

### Table 1

| Date | Version | Change Content |
| --- | --- | --- |
| 2024.03.14 | V1.0 | Initial version creation |

## Page 2

### Shenzhen Damiao Technology Co., Ltd DM-J4340-2EC User Manual V1.0
Disclaimer
Thank you for purchasing the Damiao Technology TMDAMIAOTMDM-J4340-2EC reduction motor (hereinafter referred to as "motor"). Before using this product, please carefully read and follow all safety guidelines provided in this document and by Damiao Technology, otherwise it may cause harm to you and those around you, damage this product or other surrounding items. Once you use this product, it is deemed that you have carefully read this document, understood, recognized and accepted all terms and content of this document and all related documents of this product. You promise to use this product only for legitimate purposes. You promise to take full responsibility for the use of this product and any consequences that may arise. Damiao Technology is not responsible for any damage, injury or any legal liability caused directly or indirectly by the use of this product.
DAMIAO is a trademark of Shenzhen Damiao Technology Co., Ltd. Product names, brands, etc. appearing in this document are trademarks of their respective companies. This product and manual are copyrighted by Shenzhen Damiao Technology Co., Ltd. No reproduction or printing is permitted without permission. The final interpretation rights of this document and all related documents of this product belong to Shenzhen Damiao Technology Co., Ltd. If there are updates, no further notice will be given.
Precautions
1. Please strictly use the motor according to the specified working environment and maximum allowable temperature range of the winding, otherwise it will cause permanent irreversible damage to the product.
2. Avoid foreign objects entering the rotor interior, otherwise it will cause abnormal rotor operation.
3. Please check if all components are intact before use. If there are missing, aging, damaged parts, etc., please stop using.
4. Ensure correct wiring and proper, stable motor installation.
5. Do not touch the electronic rotor part during use to avoid accidents. When the motor outputs high torque, it will generate heat, please be careful to avoid burns.
6. Users should not disassemble the motor privately, otherwise it will affect the control accuracy of the motor and even cause abnormal motor operation.
Motor Features
1. Dual encoders, output shaft single-turn absolute position, no fear of power loss causing output shaft absolute position loss.
2. Motor and driver integrated design, compact structure, high integration.
3. Supports upper computer visual debugging and firmware upgrade.
4. Can feedback motor speed, position, torque, motor temperature and other information through CAN bus.
5. Has dual temperature protection function.
6. Supports trapezoidal acceleration and deceleration in position mode.
Page 2 of 9

---

## Page 3

### Shenzhen Damiao Technology Co., Ltd DM-J4340-2EC User Manual V1.0
Item List
1. Motor (with driver) ×1
2. Power (with CAN communication terminal) connection cable: XT30(2+2)-F plug single-end connection cable (100mm) ×1
3. Debug serial signal cable: GH1.25 connection cable-3pin (different plane, 300mm) ×1
Interface and Wire Sequence Description
Specific Name-Serial Number Interface Label Description
Power Interface-1
1. Connect power through XT30(2+2)-F plug power connection cable, rated voltage is 24V, to power the motor.
2. Connect external control equipment through CAN communication terminal, can receive CAN control commands and feedback motor status information.
Power Interface-2 3. The motor contains two power interfaces, any interface can be used alone, or multiple motors can be connected in series for convenient wiring.
Connect to PC through GH1.25 connection cable-3pin, using USB to CAN debug tool (or using universal USB to serial module), and use Damiao Technology debug assistant to set motor parameters and firmware upgrade, etc.
Debug Serial-3
Page 3 of 9

---

### Table 1

| Interface and Wire Sequence Description |  |  |
| --- | --- | --- |
| Specific Name-Serial Number | Interface Label | Description |
| Power Interface-1
(with CAN communication terminal) |  | 1. Connect power through XT30(2+2)-F plug power connection cable, rated voltage is 24V, to power the motor.
2. Connect external control equipment through CAN communication terminal, can receive CAN control commands and feedback motor status information.
3. The motor contains two power interfaces, any interface can be used alone, or multiple motors can be connected in series for convenient wiring. |
| Power Interface-2
(with CAN communication terminal) |  |  |
| Debug Serial-3 |  | Connect to PC through GH1.25 connection cable-3pin, using USB to CAN debug tool (or using universal USB to serial module), and use Damiao Technology debug assistant to set motor parameters and firmware upgrade, etc. |

## Page 4

### Shenzhen Damiao Technology Co., Ltd DM-J4340-2EC User Manual V1.0
Motor Dimensions and Installation
Please refer to the motor mounting hole dimensions and positions to install the motor to the corresponding equipment.
Indicator Light Status
Green light on ERR bit is 1, indicating enable mode, normal working state
Normal State
Red light on ERR bit is 0, indicating disable mode
Indicates fault, corresponding fault types are:
8—Overvoltage; 9—Undervoltage;
A—Overcurrent; B—MOS overtemperature;
C—Motor coil overtemperature; D—Communication loss;
Abnormal State Red light flashing
E—Overload;
Can be viewed through feedback frame, or through Damiao Technology debug assistant interface display, to see what type of fault occurred.
Working Modes
MIT Mode
MIT mode is designed to be compatible with the original MIT mode, which can achieve seamless switching while being able to flexibly set the control range (P_MAX, V_MAX, T_MAX). The electronic speed controller converts the received CAN data into control variables for calculation to obtain the torque value as the current loop's current setpoint. The current loop achieves the given torque current according to its regulation law.
The control block diagram is as follows:
Page 4 of 9

---

### Table 1

| Indicator Light Status |  |  |
| --- | --- | --- |
| Normal State | Green light on | ERR bit is 1, indicating enable mode, normal working state |
|  | Red light on | ERR bit is 0, indicating disable mode |
| Abnormal State | Red light flashing | Indicates fault, corresponding fault types are:
8—Overvoltage; 9—Undervoltage;
A—Overcurrent; B—MOS overtemperature;
C—Motor coil overtemperature; D—Communication loss;
E—Overload;
Can be viewed through feedback frame, or through Damiao Technology debug assistant interface display, to see what type of fault occurred. |

## Page 5

### Shenzhen Damiao Technology Co., Ltd DM-J4340-2EC User Manual V1.0
Based on MIT mode, various control modes can be derived, such as when kp=0, kd≠0, given v_des can achieve uniform rotation; when kp=0, kd=0, given t_ff can achieve given torque output.
Note: When controlling position, kd cannot be assigned 0, otherwise it will cause motor oscillation or even loss of control.
Position Speed Mode
Position cascade mode adopts a three-loop cascade control mode, with the position loop as the outermost loop, its output as the setpoint for the speed loop, and the speed loop's output as the setpoint for the inner current loop, used to control the actual current output. The control block diagram is shown in the figure below:
p_des is the target position for control, v_des is used to limit the maximum absolute speed value during motion.
If the position cascade mode uses the control parameters recommended by the debug assistant, it can achieve good control accuracy and relatively smooth control process, but the response time is relatively long. In addition to v_des, other configurable parameters include acceleration/deceleration settings. If additional oscillation occurs during control, the acceleration/deceleration can be increased.
Note: The units of p_des and v_des are rad and rad/s respectively, data type is float, and the damping factor must be set to a non-zero positive number. Please refer to the precautions for speed mode.
Speed Mode
Speed mode allows the motor to run stably at the set speed. The control block diagram is as follows:
Page 5 of 9

---

## Page 6

### Shenzhen Damiao Technology Co., Ltd DM-J4340-2EC User Manual V1.0
Note: The unit of v_des is rad/s, data type is float. If you need to use the debug assistant to automatically calculate parameters, you need to set the damping factor to a non-zero positive number, typically ranging from 2.0 to 10.0. Too small a damping factor will bring speed oscillation and large overshoot, while too large a damping factor will bring long rise time. The recommended setting value is 4.0.
Usage
Control uses CAN standard frame format, fixed baud rate of 1Mbps, divided into receive frames and feedback frames by function. Receive frames are the received control data used to implement command control of the motor; feedback frames are the motor's status data sent to the upper controller. According to the different modes selected by the motor, the receive frame format definition and frame ID are different, but the feedback frames under various modes are the same.
Feedback Frame
The feedback frame ID is set by the debug assistant (MasterID), default is 0, mainly feeding back the motor's position, speed and torque information. The frame format definition is:
Feedback Message D[0] D[1] D[2] D[3] D[4] D[5] D[6] D[7]
MST_ID ID|ERR<<4 POS[15:8] POS[7:0] VEL[11:4] VEL[3:0]|T[11:8] T[7:0] T_MOS T_Rotor
Where:
ID represents the controller ID, taking the lower 8 bits of CAN_ID
ERR represents the status, corresponding status types are:
0—Disabled;
1—Enabled;
8—Overvoltage;
9—Undervoltage;
A—Overcurrent;
B—MOS overtemperature;
C—Motor coil overtemperature;
D—Communication loss;
E—Overload;
Page 6 of 9

---

## Page 7

### Shenzhen Damiao Technology Co., Ltd DM-J4340-2EC User Manual V1.0
POS represents the motor's position information
VEL represents the motor's speed information
T represents the motor's torque information
T_MOS represents the average temperature of the MOS tube on the driver, unit °C
T_Rotor represents the average temperature of the motor's internal coils, unit °C
Position, speed and torque use linear mapping relationship to convert floating-point data to signed fixed-point data, where position uses 16-bit data, and speed and torque both use 12-bit.
MIT Mode Control Frame
Control Message D[0] D[1] D[2] D[3] D[4] D[5] D[6] D[7]
p_des p_des v_des v_des[3:0]| Kp Kd Kd[3:0]|
ID t_ff[7:0]
[15:8] [7:0] [11:4] Kp[11:8] [7:0] [11:4] t_ff[11:8]
Frame ID equals the set CANID value
P_des: Position setpoint
V_des: Speed setpoint
Kp: Position proportional coefficient
Kd: Position differential coefficient
T_ff: Torque setpoint value
All parameters conform to the mapping relationship in the previous section, where the ranges of p_des, v_des, t_ff can be set by the debug assistant, the range of Kp is [0,500], and the range of Kd is [0,5].
Standard CAN data has only 8 bytes per frame, the MIT control command format combines the five parameters Position, Velocity, Kp, Kd, and Torque bit by bit into 8 bytes. Among them: Position occupies 2 bytes 16 bits, Velocity occupies 12 bits, Kp occupies 12 bits, Kd occupies 12 bits.
Position Speed Mode Control Frame
Control Message D[0] D[1] D[2] D[3] D[4] D[5] D[6] D[7]
0x100+ID p_des v_des
Frame ID is the set CANID value plus 0x100 offset
P_des: Position setpoint, floating-point, low byte first, high byte last
V_des: Speed setpoint, floating-point, low byte first, high byte last
The CANID for sending commands here is 0x100+ID. The speed setpoint is the highest speed under trapezoidal acceleration operation, which is the speed value of the uniform speed section.
Speed Mode Control Frame
Control Message D[0] D[1] D[2] D[3]
0x200+ID v_des
Page 7 of 9

---

### Table 1

| Control Message | D[0] | D[1] | D[2] | D[3] | D[4] | D[5] | D[6] | D[7] |
| ID | p_des
[15:8] | p_des
[7:0] | v_des
[11:4] | v_des[3:0]|
Kp[11:8] | Kp
[7:0] | Kd
[11:4] | Kd[3:0]|
t_ff[11:8] | t_ff[7:0] |

### Table 2

| Control Message | D[0] | D[1] | D[2] | D[3] | D[4] | D[5] | D[6] | D[7] |
| 0x100+ID | p_des |  |  |  | v_des |  |  |  |

### Table 3

| Control Message | D[0] | D[1] | D[2] | D[3] |
| 0x200+ID | v_des |  |  |  |

## Page 8

### Shenzhen Damiao Technology Co., Ltd DM-J4340-2EC User Manual V1.0
Frame ID is the set CANID value plus 0x200 offset
V_des: Speed setpoint, floating-point, low byte first, high byte last
The CANID for sending commands here is 0x200+ID.
Using Damiao Technology Debug Assistant
Use Damiao Technology USB to CAN debug tool to connect computer and motor, and use Damiao Technology assistant to set motor parameters and firmware upgrade.
The motor debug serial port connects to PC through GH1.25 connection cable-3pin, the CAN communication terminal in the motor power interface connects to USB to CAN debug tool through XT30(2+2)-F plug connection cable, and use Damiao Technology debug assistant to set motor parameters and firmware upgrade, etc.
After the motor's serial port, CAN port and power interface are connected, open Damiao Technology debug assistant on the computer side, select the corresponding serial port device and open the serial port. At this time, power the motor, the serial port will print information, ControlMode indicates the current drive mode.
For detailed debugging process, refer to: Debug Assistant User Manual (Damiao Drive Control Protocol) V1.4.pdf
Download link:
https://gitee.com/kit-miao/damiao/tree/master/%E5%85%B3%E8%8A%82%E7%94%B5%E6%9C%BA/%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE
Characteristic Parameters
Please use the motor reasonably according to the following parameters.
Type Characteristic Parameter DM-J4340-2EC (24V) DM-J4340-2EC (48V)
Rated Voltage 24V 48V
Rated Current 2.5A 2.5A
Peak Current 8A 8A
Motor Parameters Rated Torque 9NM 9NM
Peak Torque 27NM 27NM
Rated Speed 36rpm 36rpm
No-load Maximum Speed 52rpm 100rpm
Reduction Ratio 40:1 40:1
Pole Pairs 14 14
Motor Characteristic Values
Phase Inductance 317uH 317uH
Phase Resistance 760mΩ 760mΩ
Outer Diameter 57mm 57mm
Structure and Weight Height 53.3mm 53.3mm
Motor Weight Approximately 362g Approximately 362g
Page 8 of 9

---

### Table 1

| Type | Characteristic Parameter | DM-J4340-2EC (24V) | DM-J4340-2EC (48V) |
| Motor Parameters | Rated Voltage | 24V | 48V |
|  | Rated Current | 2.5A | 2.5A |
|  | Peak Current | 8A | 8A |
|  | Rated Torque | 9NM | 9NM |
|  | Peak Torque | 27NM | 27NM |
|  | Rated Speed | 36rpm | 36rpm |
|  | No-load Maximum Speed | 52rpm | 100rpm |
| Motor Characteristic Values | Reduction Ratio | 40:1 | 40:1 |
|  | Pole Pairs | 14 | 14 |
|  | Phase Inductance | 317uH | 317uH |
|  | Phase Resistance | 760mΩ | 760mΩ |
| Structure and Weight | Outer Diameter | 57mm | 57mm |
|  | Height | 53.3mm | 53.3mm |
|  | Motor Weight | Approximately 362g | Approximately 362g |

## Page 9

### Shenzhen Damiao Technology Co., Ltd DM-J4340-2EC User Manual V1.0
Encoder Bits 14-bit 14-bit
Encoder Encoder Count 2 2
Encoder Type Magnetic Encoder (Single Turn) Magnetic Encoder (Single Turn)
Communication Control Interface CAN@1Mbps
Parameter Adjustment Interface UART@921600bps
MIT Mode
Control Modes Speed Mode
Position Mode
Driver Overtemperature Protection, protection temperature: 120°C, overtemperature motor will exit "Enable Mode"
Motor Overtemperature Protection, set according to usage requirements, recommended not to exceed 100°C, overtemperature motor will exit "Enable Mode"
Motor Overvoltage Protection, set according to usage requirements, recommended not to exceed 32V, overvoltage will exit "Enable Mode"
Motor Overvoltage Protection, set according to usage requirements, recommended not to exceed 52V, overvoltage will exit "Enable Mode"
Control and Protection
Communication Loss Protection, if no CAN command is received within the set period, it will automatically exit "Enable Mode"
Motor Overcurrent Protection, set according to usage requirements, recommended not to exceed 9.8A, overcurrent will exit "Enable Mode"
Motor Undervoltage Protection, if the power supply voltage is below the set value, it will exit "Enable Mode", recommended power supply voltage not below 15V
Motor Undervoltage Protection, if the power supply voltage is below the set value, it will exit "Enable Mode", recommended power supply voltage not below 15V
Page 9 of 9

---

### Table 1

| Encoder | Encoder Bits | 14-bit | 14-bit |
|  | Encoder Count | 2 | 2 |
|  | Encoder Type | Magnetic Encoder (Single Turn) | Magnetic Encoder (Single Turn) |
| Communication | Control Interface | CAN@1Mbps |  |
|  | Parameter Adjustment Interface | UART@921600bps |  |
| Control and Protection | Control Modes | MIT Mode |  |
|  |  | Speed Mode |  |
|  |  | Position Mode |  |
|  | Protection | Driver Overtemperature Protection, protection temperature: 120°C, overtemperature motor will exit "Enable Mode" |  |
|  |  | Motor Overtemperature Protection, set according to usage requirements, recommended not to exceed 100°C, overtemperature motor will exit "Enable Mode" |  |
|  |  | Motor Overvoltage Protection, set according to usage requirements, recommended not to exceed 32V, overvoltage will exit "Enable Mode" | Motor Overvoltage Protection, set according to usage requirements, recommended not to exceed 52V, overvoltage will exit "Enable Mode" |
|  |  | Communication Loss Protection, if no CAN command is received within the set period, it will automatically exit "Enable Mode" |  |
|  |  | Motor Overcurrent Protection, set according to usage requirements, recommended not to exceed 9.8A, overcurrent will exit "Enable Mode" |  |
|  |  | Motor Undervoltage Protection, if the power supply voltage is below the set value, it will exit "Enable Mode", recommended power supply voltage not below 15V | Motor Undervoltage Protection, if the power supply voltage is below the set value, it will exit "Enable Mode", recommended power supply voltage not below 15V | 